local HttpService = game:GetService("HttpService")
local player = game.Players.LocalPlayer

-- ã€è«‹ç¢ºèª Webhook æ­£ç¢ºã€‘
local WebhookURL = "https://discord.com/api/webhooks/1468528458056339529/WKTq9fLdmYaWVaM4b-yy78n9cEP5qB2NQx254k1pMLqJusi6HFefvtBL3vOaKznHoiFH"

print("--- [Mac ç©©å®šç‰ˆ] ä»»å‹™æ¡é›†å™¨å·²å•Ÿå‹• ---")

-- 1. è¬ç”¨ç™¼é€å‡½æ•¸ (è‡ªå‹•åµæ¸¬ Mac åŸ·è¡Œå™¨å‡½æ•¸)
local function MacSend(content)
    local req = (syn and syn.request) or (http and http.request) or http_request or request
    if req then
        task.spawn(function()
            local success, err = pcall(function()
                req({
                    Url = WebhookURL,
                    Method = "POST",
                    Headers = {["Content-Type"] = "application/json"},
                    Body = HttpService:JSONEncode({content = content})
                })
            end)
            if success then print("âœ… Discord è¨Šæ¯å·²é€å‡º") else warn("âŒ Webhook éŒ¯èª¤: " .. tostring(err)) end
        end)
    else
        warn("âš ï¸ æ‰¾ä¸åˆ°å¯ç”¨çš„ Request å‡½æ•¸ï¼Œè«‹æª¢æŸ¥åŸ·è¡Œå™¨æ¬Šé™")
    end
end

-- 2. åˆå§‹æ¸¬è©¦ï¼ˆåŸ·è¡Œå¾Œ Discord æ‡‰è©²ç«‹åˆ»æ”¶åˆ°è¨Šæ¯ï¼‰
MacSend("ğŸš€ Mac æ¡é›†å™¨å·²é€£ç·šï¼ç›®å‰çš„ç­‰ç´š: " .. player.Data.Level.Value)

-- 3. UI æƒæé‚è¼¯ (é¿é–‹ Hooking å ±éŒ¯)
local lastLog = ""
task.spawn(function()
    while task.wait(1.5) do
        -- åˆ¤æ–·ä»»å‹™é¸å–®æ˜¯å¦æ‰“é–‹
        local mainGui = player.PlayerGui:FindFirstChild("Main")
        local questGui = mainGui and mainGui:FindFirstChild("Quest")
        
        if questGui and questGui.Visible then
            local container = questGui:FindFirstChild("Container")
            if container then
                local foundText = "ğŸ“ åµæ¸¬åˆ°ä»»å‹™é¸é …ï¼š\n"
                local hasTasks = false
                
                for _, item in pairs(container:GetChildren()) do
                    if item:IsA("TextButton") and item.Text ~= "" then
                        foundText = foundText .. "- " .. item.Text .. "\n"
                        hasTasks = true
                    end
                end
                
                -- æ¯”å°æ˜¯å¦ç‚ºæ–°å…§å®¹
                if hasTasks and foundText ~= lastLog then
                    lastLog = foundText
                    print("ğŸ¯ æ•æ‰æˆåŠŸï¼")
                    MacSend("```\n" .. foundText .. "\n```")
                end
            end
        end
    end
end)
