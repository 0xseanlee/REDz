local TweenService = game:GetService("TweenService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local player = game.Players.LocalPlayer

-- ã€åƒæ•¸è¨­å®šã€‘
local SPEED = 360 -- æ»‘è¡Œé€Ÿåº¦ï¼Œ300-350 æ˜¯ç›¸å°å®‰å…¨çš„æ¥µé™
local NPC_POS = CFrame.new(1386, 87, -1298) -- é›ªåœ°å³¶ NPC åº§æ¨™

print("--- âœˆï¸ [é˜²æ‹‰å›ç³»çµ±] å•Ÿå‹•æ¥µé€Ÿæ»‘è¡Œæ¸¬è©¦ ---")

-- æ ¸å¿ƒå‡½æ•¸ï¼šå¹³æ»‘ç§»å‹•åˆ°ç›®çš„åœ°
local function SmoothMove(targetCFrame)
    local root = player.Character:FindFirstChild("HumanoidRootPart")
    if not root then return end
    
    local distance = (root.Position - targetCFrame.p).Magnitude
    local duration = distance / SPEED
    
    local info = TweenInfo.new(duration, Enum.EasingStyle.Linear)
    local tween = TweenService:Create(root, info, {CFrame = targetCFrame})
    
    -- æ»‘è¡ŒæœŸé–“é—œé–‰é‡åŠ›ï¼Œé˜²æ­¢æ‰ä¸‹å»
    local bv = Instance.new("BodyVelocity")
    bv.Velocity = Vector3.new(0, 0, 0)
    bv.Parent = root
    
    tween:Play()
    tween.Completed:Wait() -- ç­‰å¾…åˆ°é”
    
    bv:Destroy()
end

-- æ¸¬è©¦ï¼šé£›éå»æ¥ä»»å‹™
task.spawn(function()
    print("ğŸ“ æ­£åœ¨æ»‘è¡Œè‡³ NPC...")
    SmoothMove(NPC_POS)
    
    task.wait(0.5) -- åˆ°é”å¾Œç¨å¾®åœé “ï¼Œè®“ä¼ºæœå™¨åŒæ­¥ä½ç½®
    
    print("ğŸ“¨ ç™¼é€ SnowQuest è«‹æ±‚...")
    local success = ReplicatedStorage.Remotes.CommF_:InvokeServer("StartQuest", "SnowQuest", 1)
    
    if success then
        print("âœ… ä»»å‹™é ˜å–æˆåŠŸï¼Œä¸”æœªè§¸ç™¼æ‹‰å›ï¼")
    else
        -- å¦‚æœ StartQuest ä¸è¡Œï¼Œè©¦è©¦ AcceptQuest
        ReplicatedStorage.Remotes.CommF_:InvokeServer("AcceptQuest", "SnowQuest", 1)
    end
end)
