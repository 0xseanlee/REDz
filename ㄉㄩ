local player = game.Players.LocalPlayer
local vUser = game:GetService("VirtualUser")

-- --- UI å»ºç«‹ ---
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "AutoM1_UI"
screenGui.Parent = player:WaitForChild("PlayerGui")
screenGui.ResetOnSpawn = false -- è§’è‰²æ­»æ‰ UI ä¸æœƒæ¶ˆå¤±

local mainButton = Instance.new("TextButton")
mainButton.Size = UDim2.new(0, 120, 0, 50)
mainButton.Position = UDim2.new(0, 50, 0.5, 0) -- è¢å¹•å·¦å´ä¸­é–“
mainButton.BackgroundColor3 = Color3.fromRGB(200, 50, 50) -- åˆå§‹ç´…è‰²
mainButton.Text = "M1: OFF"
mainButton.TextColor3 = Color3.new(1, 1, 1)
mainButton.Font = Enum.Font.SourceSansBold
mainButton.TextSize = 20
mainButton.Parent = screenGui

-- åœ“è§’æ•ˆæœ
local corner = Instance.new("UICorner")
corner.CornerRadius = UDim.new(0, 10)
corner.Parent = mainButton

-- --- é‚è¼¯åŠŸèƒ½ ---
getgenv().AutoM1_Toggle = false

-- é»æ“Šåˆ‡æ›é–‹é—œ
mainButton.MouseButton1Click:Connect(function()
    getgenv().AutoM1_Toggle = not getgenv().AutoM1_Toggle
    
    if getgenv().AutoM1_Toggle then
        mainButton.Text = "M1: ON"
        mainButton.BackgroundColor3 = Color3.fromRGB(50, 200, 50) -- è®Šæˆç¶ è‰²
        print("âœ… è‡ªå‹•æ™®æ”»é–‹å•Ÿ")
    else
        mainButton.Text = "M1: OFF"
        mainButton.BackgroundColor3 = Color3.fromRGB(200, 50, 50) -- è®Šæˆç´…è‰²
        print("ğŸ›‘ è‡ªå‹•æ™®æ”»é—œé–‰")
    end
end)

-- --- æ ¸å¿ƒç©©å®šæ™®æ”»å¾ªç’° ---
task.spawn(function()
    while true do
        if getgenv().AutoM1_Toggle then
            pcall(function()
                local char = player.Character
                local tool = char and char:FindFirstChildOfClass("Tool")
                
                if tool then
                    -- ä½¿ç”¨ VirtualUser é»æ“Šè¢å¹•ä¸­å¿ƒ
                    vUser:CaptureController()
                    vUser:Button1Down(Vector2.new(640, 360)) 
                    
                    -- åŒæ­¥æ¿€æ´»å·¥å…·
                    tool:Activate()
                end
            end)
        end
        -- è¨­å®šç‚ºã€Œæ…¢æ…¢çš„ã€é€Ÿåº¦ï¼šæ¯ 0.25 ç§’æ®ä¸€æ¬¡ (é©åˆå¤§å¤šæ•¸æ­¦å™¨ç¯€å¥)
        task.wait(0.25) 
    end
end)
